FROM mcr.microsoft.com/dotnet/framework/runtime:4.8.1-20220913-windowsservercore-ltsc2022

ARG SQLCOLLATION SHARE_PATH SHARE_LOGIN SHARE_PASSWORD
RUN net use X: %SHARE_PATH% /user:"%SHARE_LOGIN%" "%SHARE_PASSWORD%" \
&& X:/SQLServer2022-x64-ENU/setup.exe /q /ACTION=Install /FEATURES=SQLENGINE /INSTANCENAME=MSSQLSERVER /SECURITYMODE=SQL /SAPWD=qGH6RFvq /SQLSVCACCOUNT="NT AUTHORITY\System" /SQLSYSADMINACCOUNTS="BUILTIN\Administrators" /TCPENABLED=1 /IACCEPTSQLSERVERLICENSETERMS /SQLCOLLATION=%SQLCOLLATION%

COPY start.ps1 /
ENV SA_PASSWORD=_ ACCEPT_EULA=_
CMD powershell -Command (C:/start.ps1 -SA_PASSWORD $env:SA_PASSWORD -ACCEPT_EULA $env:ACCEPT_EULA -Verbose)